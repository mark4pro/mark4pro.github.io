/** Copyright (c) 2016 WIMI5. All rights reserved. */ (function(){var k=void 0;var l;
l=function(c){function m(){var a=this;this.f=["en"];this.b=this.c="en";this.a=this.d=k;this.m=function(b){if(b!==a.b){if(!b)throw a.d.warn(b+" is not a valid language"),new c.pengoError.pengoError.PengoError(b+" is not a valid language",c.pengoError.codes.codes.INVALID_DATA);if(!a.h(b))throw a.d.warn(b+" is not a supported language"),new c.pengoError.pengoError.PengoError(b+" is not a supported language",c.pengoError.codes.codes.INVALID_TYPE);a.b=b;a.a.emit("LANGUAGE_UPDATED")}};this.g=function(){return a.b};this.j=
function(b,d,g){if(b===k||"string"!==typeof b)c.util.callback.call(d,g||a,new c.pengoError.pengoError.PengoError("'url' must de a defined string",c.pengoError.codes.codes.INVALID_TYPE));-1===b.indexOf("#")&&c.util.callback.call(d,g||a,new c.pengoError.pengoError.PengoError(b+" 'url' must contain wildcard '#'",c.pengoError.codes.codes.INVALID_DATA));b=b.replace("#",a.b);c.require.require.requireJSON(b,function(b,f){if(b)c.util.callback.call(d,g||a,b);else{try{f=JSON.parse(f)}catch(h){c.util.callback.call(d,
g||a,h);return}c.util.callback.call(d,g||a,k,f)}})}}var h={LANGUAGE_UPDATED:"language/updated"};m.prototype={i:function(a){this.d=a},e:function(a){if(this.a!==a){if(this.a)try{this.a.removeEvents(h)}catch(b){this.d.warn("Error "+b+" while removing events when changing events manager")}(this.a=a)&&this.a.registerEvents(h)}return this.a!==k},l:function(a){if(a&&(a.supportedLangs&&(this.f=a.supportedLangs),a.defLang&&(this.c=a.defLang),!this.h(this.c)))throw this.d.error("'"+this.c+"' can't be the default language because it is not supported"),
new c.pengoError.pengoError.PengoError(this.c+" can't be the default language because it is not supported",c.pengoError.codes.codes.INVALID_CONFIG);},h:function(a){for(var b in this.f)if(this.f[b]===a)return!0;return!1},g:function(){return this.b},k:function(){return"#"}};return m};var n=["PENGO","client","plugins","languageManager","activator"],p=this;!(n[0]in p)&&p.execScript&&p.execScript("var "+n[0]);for(var r;n.length&&(r=n.shift());){var s;if(s=!n.length)s=!1;s?p[r]=k:p=p[r]?p[r]:p[r]={}}
(function(){function c(){d.off("SERVICE_REGISTERED",c);if(f=d.getService("igloo.logger")[0])if(d.getService("igloo.eventsManager")[0])e||(e=new b),e.i(f),e.l(g.config),e.e(d.getService("igloo.eventsManager")[0]),q={functions:{getTexts:e.j,getLanguage:e.g,setLanguage:e.m,getWildcard:e.k},properties:{}},d.register(a,q),d.on("SERVICE_UNREGISTERED",h),d.on("SERVICE_UPDATED",t);else d.on("SERVICE_REGISTERED",c);else d.on("SERVICE_REGISTERED",c)}function m(b){e&&e.e(k);q&&d.unregister(a,q);d.off("SERVICE_UNREGISTERED",
h);d.off("SERVICE_UPDATED",t);if(b)d.on("SERVICE_REGISTERED",c);else d.off("SERVICE_REGISTERED",c)}function h(a){switch(a){case "igloo.logger":f=d.getService("igloo.logger")[0];e.i(f);break;case "igloo.eventsManager":if(e.e(d.getService("igloo.eventsManager")[0]))return;break;default:return}m(!0)}var a="languageManager",b,d,g,e,f,q,t=h;window.PENGO.client.plugins.languageManager.activator.activator=function(a){return{start:function(e,f){d=e;g=f;if(!b){if(!l)throw new a.pengoError.pengoError.PengoError("'PENGO.client.plugins.languageManager.languageManager' can't be resolved.",
a.pengoError.codes.NOT_FOUND);b=l(a);a.require.remove.deleteByName("PENGO.client.plugins.languageManager.languageManager")}c()},stop:m}}})();})();
